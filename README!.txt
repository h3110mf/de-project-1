Привет, Максим, направляю


Да, твоя рекомендация по поводу NTILE зашла очень удачно)) оказывается на стыке ранжирования (1,2   2,3 и т.п.) у нас получились разные значения
т.е. например 198 у меня был 1, а 199 - уже 2, после NTILE 199 так же оказался 1, а уже, к примеру 200, 2

Добавил в recency пустышки, принудительно заменил на "1", в общее ранжирование не включил, т.к. считаю не правильным их смешивать с  основной статистикой 
и тем самым "отбирать статус" у "заслуживших" свой ранг 2, которые сделали заказ относительно недавно, на 1 к примеру, и наоборот)

На витрине monetary value и frequency обернул coalesce.

Данные по ограничениям скопировал прям из dbeaver
(извини, если форма оказалась другая, но я так понимаю, что форма рекомендуема, а не требуема))

